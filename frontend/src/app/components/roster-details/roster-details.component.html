<div class="roster-details-container">
  <div class="header">
    <h1>{{ roster?.name || 'Roster' }}</h1>
    <p class="subtitle">{{ roster?.league?.name }}</p>
    <button class="back-btn" (click)="goBack()">← Nazad</button>
  </div>

  <div class="content-wrapper">
    <!-- Left Panel: Players List -->
    <div class="left-panel">
      <div class="filters-section">
        <div class="filter-row">
          <div class="filter-item">
            <label>Pretraži po imenu</label>
            <input type="text" class="search-input"
                   [(ngModel)]="searchTerm"
                   (input)="applyFilters()"
                   placeholder="Pretraži igrača...">
          </div>

          <div class="filter-item">
            <label>Pozicija</label>
            <select class="select-input" [(ngModel)]="selectedPosition" (change)="applyFilters()">
              <option *ngFor="let pos of positions" [value]="pos">{{ pos }}</option>
            </select>
          </div>

          <div class="filter-item">
            <label>Tim</label>
            <select class="select-input" [(ngModel)]="selectedTeam" (change)="applyFilters()">
              <option *ngFor="let team of teams" [value]="team">{{ team }}</option>
            </select>
          </div>

          <div class="filter-item">
            <label>Cena</label>
            <select class="select-input" [(ngModel)]="priceFilter" (change)="applyFilters()">
              <option *ngFor="let price of priceOptions" [value]="price">{{ price }}</option>
            </select>
          </div>

          <div class="filter-item">
            <button class="reset-btn" (click)="resetFilters()">
              Resetuj
            </button>
          </div>
        </div>

        <div class="player-count">
          <span>{{ filteredPlayers.length }} igrača prikazano</span>
        </div>
      </div>

      <!-- Players List -->
      <div class="players-list-container">
        <div *ngIf="isLoading" class="loading">
          <p>Učitavanje igrača...</p>
        </div>

        <div *ngIf="!isLoading" class="players-list">
          <div *ngFor="let player of filteredPlayers" 
               class="player-card" 
               [ngStyle]="{'background-color': getTeamColor(player.team)}">
            <img class="team-logo" [src]="getTeamLogo(player.team)" [alt]="player.team">
            <div class="player-info">
              <h3>{{ player.firstName }} {{ player.lastName }}</h3>
              <p class="player-details">{{ player.team }} - {{ player.position }}</p>
            </div>
            
            <div class="player-stats">
              <div class="stat">
                <span class="stat-label">Cena</span>
                <span class="stat-value">${{ player.price }}M</span>
              </div>
            </div>

            <div class="player-action">
              <button *ngIf="!isPlayerInRoster(player.id)" 
                      class="add-btn" 
                      (click)="addPlayerToRoster(player.id)">
                +
              </button>
              <button *ngIf="isPlayerInRoster(player.id)" 
                      class="remove-btn" 
                      (click)="removePlayerFromRoster(player.id)">
                ✕
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Panel: Roster Display -->
    <div class="right-panel">
      <div class="roster-stats">
        <div class="stat-item">
          <span class="stat-label">Budžet</span>
          <span class="stat-value">${{ roster?.budget?.toFixed(2) }}M</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Igrači</span>
          <span class="stat-value">{{ rosterPlayers.length }}/13</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Pobede</span>
          <span class="stat-value">{{ roster?.wins || 0 }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Porazi</span>
          <span class="stat-value">{{ roster?.losses || 0 }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Ukupan broj poena</span>
          <span class="stat-value">{{ roster?.points || 0 }}</span>
        </div>
      </div>

      <!-- Field Visualization -->
      <div class="field-container">
        <div class="field">
          <!-- Starting 8 Players -->
          <div class="field-row starters-row">
            <div *ngFor="let starter of getStarterPlayers()" 
                 class="player-card-field"
                 [ngStyle]="{'background-color': getTeamColor(starter.player.team)}">
              <button class="remove-field-btn" (click)="removePlayerFromRoster(starter.player.id)">✕</button>
              <span class="player-price">${{ starter.player.price }}M</span>
              <img class="field-team-logo" [src]="getTeamLogo(starter.player.team)" [alt]="starter.player.team">
              <span class="player-name">{{ starter.player.firstName }} {{ starter.player.lastName }}</span>
              <span class="player-position">{{ starter.player.position }}</span>
            </div>
          </div>

          <!-- Empty slots for starters -->
          <div class="field-row starters-row">
            <ng-container *ngFor="let starterSlot of getEmptyStarterSlots()">
              <div class="empty-slot" [attr.data-position]="starterSlot.position">
                <span class="position-label">{{ starterSlot.position }}</span>
                <span class="plus-sign">+</span>
              </div>
            </ng-container>
          </div>

          <!-- Bench 5 Players -->
          <div class="bench-section">
            <h3>Klupa ({{ getBenchPlayers().length }}/5)</h3>
            <div class="bench-row">
              <div *ngFor="let bench of getBenchPlayers()" 
                   class="player-card-field bench-card"
                   [ngStyle]="{'background-color': getTeamColor(bench.player.team)}">
                <button class="remove-field-btn" (click)="removePlayerFromRoster(bench.player.id)">✕</button>
                <span class="player-price">${{ bench.player.price }}M</span>
                <img class="field-team-logo" [src]="getTeamLogo(bench.player.team)" [alt]="bench.player.team">
                <span class="player-name">{{ bench.player.firstName }} {{ bench.player.lastName }}</span>
                <span class="player-position">{{ bench.player.position }}</span>
              </div>
            </div>

            <!-- Empty slots for bench -->
            <div class="bench-row">
              <div *ngFor="let i of [].constructor(5 - getBenchPlayers().length)" 
                   class="empty-slot">
                <span>+</span>
              </div>
            </div>
          </div>

          <!-- Captain Selection -->
          <div class="captain-section">
            <h3>Kapiten tima</h3>
            <div class="captain-display">
              <div *ngIf="getCaptain(); else noCaptain" class="captain-card" 
                   [ngStyle]="{'background-color': getTeamColor(getCaptain()!.player.team)}">
                <span class="captain-badge">C</span>
                <img class="captain-team-logo" [src]="getTeamLogo(getCaptain()!.player.team)" [alt]="getCaptain()!.player.team">
                <span class="captain-name">{{ getCaptain()!.player.firstName }} {{ getCaptain()!.player.lastName }}</span>
                <span class="captain-position">{{ getCaptain()!.player.position }}</span>
                <button class="remove-captain-btn" (click)="removeCaptain()">✕</button>
              </div>
              <ng-template #noCaptain>
                <div class="no-captain">
                  <span>Kapiten nije izabran</span>
                </div>
              </ng-template>
            </div>
            
            <div *ngIf="!getCaptain()" class="captain-options">
              <p class="captain-label">Izaberite kapiten a od startera:</p>
              <div class="starter-buttons">
                <button *ngFor="let starter of getStarterPlayers()" 
                        class="starter-select-btn"
                        [ngStyle]="{'background-color': getTeamColor(starter.player.team)}"
                        (click)="setCaptain(starter.player.id)">
                  {{ starter.player.firstName }} {{ starter.player.lastName }} ({{ starter.player.position }})
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

